<html>

<head>
  <title>Snake Canvas</title>
</head>

<body>
  <canvas id="game" width="400" height="400"></canvas>
  <style>
    #game {
      border: 3px solid #000;
    }
  </style>
  <script>
    var canvas = document.getElementById('game');
    var context = canvas.getContext('2d');
    document.addEventListener('keydown', keyPush);

    var posX = 0;
    var posY = 0;
    var velX = 1;
    var velY = 0;
    var tick = 10;
    var speed = 10;
    var tailLen = 20;
    var tail = [];
    var fruitX;
    var fruitY;

    newFruit();
    setInterval(game, 1000 / speed);

    function game() {
      context.clearRect(0, 0, canvas.width, canvas.height);
      posX += velX * tick;
      posY += velY * tick;
      checkIfInCanvas()
      checkSnakeCollision();
      tail.unshift({ x: posX, y: posY });
      tail.splice(tailLen);
      for (var i = 0; i < tail.length; i++) {
        context.fillRect(tail[i].x, tail[i].y, tick, tick);
      }
      context.fillRect(fruitX, fruitY, 10, 10);
      checkFruitCollision();
    }

    function newGame() {
      console.log('#### NEW GAME ####');
      posX = 0;
      posY = 0;
      velX = 1;
      velY = 0;
      tailLen = 20;
      tail = [];
      newFruit();
    }

    function checkIfInCanvas() {
      if (posX >= canvas.width) {
        posX = 0;
      } else if (posX < 0) {
        posX = canvas.width;
      }
      if (posY >= canvas.height) {
        posY = 0;
      } else if (posY < 0) {
        posY = canvas.height;
      }
    }

    function checkSnakeCollision() {
      for (var i = 1; i < tail.length; i++) {
        if (posX >= tail[i].x && posX < tail[i].x + tick
          && posY >= tail[i].y && posY < tail[i].y + tick) {
            console.log('#### SNAKE COLISION OCCURED ####');
            newGame();
        }
      }
    }

    function checkFruitCollision() {
      if (posX >= fruitX && posX < fruitX + tick
        && posY >= fruitY && posY < fruitY + tick) {
        console.log('#### FRUIT COLISION OCCURED ####');
        tailLen++;
        newFruit();
      }
    }

    function newFruit() {
      console.log('#### NEW FRUIT ####');
      fruitX = Math.floor(Math.random() * canvas.width / tick) * tick;
      fruitY = Math.floor(Math.random() * canvas.height / tick) * tick;
    }

    function keyPush(event) {
      console.log(event.keyCode);
      switch (event.keyCode) {
        case 37:
          if (velX === 0) {
            velX = -1;
            velY = 0;
          }
          break;
        case 38:
          if (velY === 0) {
            velX = 0;
            velY = -1;
          }
          break;
        case 39:
          if (velX === 0) {
            velX = 1;
            velY = 0;
          }
          break;
        case 40:
          if (velY === 0) {
            velX = 0;
            velY = 1;
          }
          break;

        default:
          break;
      }
    }
  </script>
</body>

</html>